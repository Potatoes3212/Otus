# ADR-3 Способ интеграции с внешними системами

## Контекст
Продукт интегрирован с большим количеством внешних систем:
* Системы корпоративной экосистемы 
* Системы не принадлежащие корпорации

### Архитектурные драйверы
* Количество интеграций постоянно возрастает
* Воздействовать на внешние системы для совместного формирования контракта данных невозможно 
* Внешние системы предоставляют разные методы интеграции
  * REST API
  * RPC API 
  * GraphQL API
  * MQ 
### Цели
* Не подстраивать систему под внешние интеграции 
* Переиспользовать архитектурные решения в разных сценариях взаимодействия
* Выполнять внешние интеграции с минимальными затратами ресурсов

## Критичные сценарии и критичные характеристики
**Критичные сценарии:**
* Необходимо интегрироваться с новой внешней системой
* Внешняя система выпускает обновление версии API с изменениями в контракте данных
* Внешняя система предоставляет новый метод интеграции.

**Критерии оценки решений:**
* Отказоустойчивость решения в рамках всей системы
* Влияние на скорость выполнения будущих интеграций

## Варианты решения 
### Решение 1. Создавать для каждой внешней системы адаптер 
**Преимущества**
* Контекст внешних систем не "протекает" в нашу систему
* Доработки при изменении контракта данных с внешней системой не затрагивают сервис реализующий основную бизнес логику
* Упрощается мониторинг работоспособности внешней системы

**Недостатки**
* Дополнительные сетевые хопы
* Усложнение инфраструктуры
* Увеличение времени выполнения запроса
* Дополнительная точка отказа
* Дополнительные ресурсы на:
  *  разработку
  *  развёртывание 
  *  поддержку 

### Решение 2. Интегрироваться с внешними системами без адаптера
**Преимущества**
* Скорость выполнения запроса выше, чем в варианте с адаптером
* Нет дополнительной точки отказа
* Нет дополнительных затрат ресурсов на развёртывание адаптера 

**Недостатки**
* Все изменения в контрактах данных напрямую влияют на сервис, реализующий бизнес логику
* Усложнение сервиса, реализующего бизнес логику поддержкой разных контактов данных
* Скорость будущих интеграций будет снижаться за счёт увеличения кодовой базы сервиса

# Решение 
Выбрано решение 1 т.к. для облегчения будущих интеграций стоит изолировать внешние системы от собственной бизнес логики.
>Создавать для каждой внешней системы адаптер 

## Последствия решения 
**Положительные**
* Все внешние системы закрыты за адаптерами, контекст внешних систем не используется в бизнес логике продукта 
* Замена одной системы на другую в большинстве случаев требует модификации лишь адаптера
* Каждая внешняя система мониторится отдельно с помощью своего адаптера.

**Отрицательные**
* Усложнение инфраструктуры, за счёт написания большого количества адаптеров
* Дополнительные расходы ресурсов на написание и эксплуатацию адаптеров